%% 産業技術大学院大学紀要LaTeXスタイルシート
%% Y.Chubachi 2012,2013

%% 参考
%% http://ea3pch.yz.yamagata-u.ac.jp/member/sumio/tex/styleuse.pdf

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 基本版面
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% 余白
% ---------------------
% 天（上余白）    | 30mm
% 地（下余白）    | 18mm
% ノド（内側余白）| 24mm
% 小口（外側余白）| 18mm
% ---------------------
%
% 版面（A4）
% ------------
% 幅   | 168mm
% 高さ | 255.5mm
% ------------
% ※高さは\baselineskipの整数倍＋\topskipに補正し242mmほどになる．
%   この補正により，footnoteの下側が揃う（しないとはみ出る）．

\usepackage[
  top=30truemm,	      % 天（上余白）
  inner=24truemm,     % ノド（内側余白）
  bottom=22.5truemm,  % 地（下余白）
  outer=18truemm,     % 小口（外側余白）
  heightrounded,      % ※高さの補正
  dvipdfm]{geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% パッケージ
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{nlines} % 行取り用パッケージ（自作）

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% ページ番号
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagestyle{empty}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% タイトルの定義
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% 概要とキーワードの横幅を指定します
\newlength{\abstractwidth}
\setlength{\abstractwidth}{46zw} % 56字-5字-5字=46字

% 概要を登録するための命令を定義します
\renewenvironment{abstract}
  % 概要の開始
  {\global\setbox\@abstractbox\hbox\bgroup % \egroupまでをboxに登録
   \begin{minipage}[b]{\abstractwidth} % ミニページの幅を設定します
    }
  % 概要の終了
  {\end{minipage}\egroup}
\newcommand*{\keywords}[1]{\gdef\@keywords{#1}}


% \maketitleを再定義します  
\renewcommand{\maketitle}{\par
  \begingroup
    \renewcommand\thefootnote{\@fnsymbol\c@footnote}%
    \def\@makefnmark{\rlap{\@textsuperscript{\normalfont\@thefnmark}}}%
    \setcounter{footnote}{1}% footnote番号を1から開始します
    \long\def\@makefntext##1{\advance\leftskip 3zw
    \parindent 1zw\noindent
    \llap{\@textsuperscript{\normalfont\@thefnmark}\hskip0.3zw}##1}%
    \twocolumn[
      \@maketitle
    ]%
    \plainifnotempty
    \@thanks
  \endgroup
  \setcounter{footnote}{0}% footnote番号を初期化します
  \global\let\thanks\relax
  \global\let\maketitle\relax
  \global\let\@thanks\@empty
  \global\let\@author\@empty
  \global\let\title\relax
  \global\let\author\relax
  \global\let\and\relax}

% 標題全体を出力します
\def\@maketitle{%
  \let\footnote\thanks % ??
  \vskip\baselineskip % 1行あき
  \begin{center}
    % 和文標題
    \ifx\@title\@undefined\else
      \nlines{\LARGE \@title \par}
      \vskip\baselineskip % 1行あき
    \fi
    % 和文著者名
    \ifx\@author\@undefined\else
      \nlines{\Large \@author \par}
      \vskip\baselineskip % 1行あき
    \fi
    % 英文標題
    \ifx\@etitle\@undefined\else
      \nlines{\LARGE \@etitle \par}
      \vskip\baselineskip % 1行あき
    \fi
    % 英文著者名
    \ifx\@eauthor\@undefined\else
      \nlines{\large \@eauthor}
      \vskip\baselineskip % 1行あき
    \fi
    % 概要
    \ifx\@abstractbox\@undefined\else
      \nlines{\large \textbf{Abstract}\par} % 概要の表題
      \nlines{\box\@abstractbox} % 概要の内容
    \fi
    % キーワード
    \ifx\@keywords\@undefined\else
      \nlines{{\parbox{\abstractwidth}
              {\textbf{Keywords:} \@keywords}}}
    \fi
  \end{center}
}

% % 受付日を出力するための命令定義です
% \newcommand*{\receivedon}[1]{\gdef\@receivedon{#1}}
% \newcommand*{\makereceivedon}{
%   \footnotetext{\hspace{-4.5ex} Received on \@receivedon.}
% }

\newcommand*{\etitle}[1]{\gdef\@etitle{#1}}
\newcommand*{\eauthor}[1]{\gdef\@eauthor{#1}}

% \renewcommand{\maketitle}{\par
%   \begingroup
%     \renewcommand\thefootnote{\@fnsymbol\c@footnote}%
%     \def\@makefnmark{\rlap{\@textsuperscript{\normalfont\@thefnmark}}}%
%     \long\def\@makefntext##1{\advance\leftskip 3zw
%       \parindent 1zw\noindent
%       \llap{\@textsuperscript{\normalfont\@thefnmark}\hskip0.3zw}##1}%
%     \if@twocolumn % 二段組の場合
%       \ifnum \col@number=\@ne
% 	\@maketitle
%       \else
% 	\twocolumn[\@maketitle]% 一段組にして出力
%       \fi
%     \else         % 一段組の場合
%       \newpage
%       \global\@topnum\z@  % Prevents figures from going at top of page.
%       \@maketitle
%     \fi
%     \plainifnotempty
%     \@thanks
%   \endgroup
%   \setcounter{footnote}{0}%
%   \global\let\thanks\relax
%   \global\let\maketitle\relax
%   \global\let\@thanks\@empty
%   \global\let\@author\@empty
%   \global\let\@date\@empty
%   \global\let\@title\@empty
%   \global\let\@etitle\@empty % 追加
%   \global\let\@eauthor\@empty % 追加
%   \global\let\title\relax
%   \global\let\author\relax
%   \global\let\date\relax
%   \global\let\etitle\relax % 追加
%   \global\let\eauthor\relax % 追加
%   \global\let\and\relax
% }

% \def\@maketitle{%
%   \newpage\null
%   \vskip \baselineskip % 1行あき
%   \begin{center}%
%     \let\footnote\thanks
%     {\LARGE \@title \par}%
%     \vskip 1.5em
%     {\large
%       \lineskip .5em
%       \begin{tabular}[t]{c}%
% 	\@author
%       \end{tabular}\par}%
%     \vskip 1em
%     {\LARGE \@etitle \par}%
%     \vskip 1.5em
%     {\large
%       \lineskip .5em
%       \begin{tabular}[t]{c}%
% 	\@eauthor
%       \end{tabular}\par}%
%   \end{center}%
%   \par\vskip 1.5em
%   \ifvoid\@abstractbox\else\centerline{\box\@abstractbox}\vskip1.5em\fi
% }
